var mainPjaxContainerId="jbolt-container";var mainPjaxContainer="#jbolt-container";(function(a){a.fn.extend({toJsonObject:function(){var c={};var b=this.serializeArray();a.each(b,function(){if(c[this.name]){if(!c[this.name].push){c[this.name]=[c[this.name]]}c[this.name].push(this.value||"")}else{c[this.name]=this.value||""}});return c}})})(jQuery);(function(a){a.fn.extend({toggleContent:function(c){var b=this.html();if(b&&b>0){this.html("")}else{this.html(c)}}})})(jQuery);function randomId(){var a=Math.random();a=a.toString().replace(".","");return new Date().getTime()+a}var SwitchBtn={init:function(parentId){var that=this;var parentId=parentId?("#"+parentId):"body";var btns=$(parentId).find("img[data-switchbtn]");if(btns&&btns.length>0){var switchIt=function(_btn){var url=_btn.data("url");var src=_btn.attr("src");var hander=_btn.data("handler");LayerMsgBox.loading("正在执行...",10000);$.ajax({type:"post",url:url,timeout:10000,dataType:"json",success:function(data){if(data.state=="ok"){LayerMsgBox.success("操作成功",1000);var on=src.indexOf("off")!=-1;if(src.indexOf("off")!=-1){src=src.replace("off","on")}else{src=src.replace("on","off")}_btn.attr("src",src);if(hander){var exe=eval(hander);if(exe){exe(_btn,on)}}}else{LayerMsgBox.alert(data.msg,2)}},error:function(){LayerMsgBox.alert("操作失败",2)}})};btns.each(function(){var _btn=$(this);_btn.unbind("click").on("click",function(e){e.preventDefault();e.stopPropagation();var url=_btn.data("url");var confirm=_btn.data("confirm");if(url){if(confirm){LayerMsgBox.confirm(confirm,function(){switchIt(_btn)})}else{switchIt(_btn)}}else{LayerMsgBox.alert("组件未设置URL地址",2)}})})}}};var DragScrollUtil={init:function(b){var a=function a(){this.dragWrap=$("#"+b);this.init.apply(this,arguments)};a.prototype={constructor:a,_dom:{},_x:0,_y:0,_top:0,_left:0,move:false,down:false,init:function(){this.bindEvent()},bindEvent:function(){var c=this;$("body").on("mousedown","#"+b,function(d){d&&d.preventDefault();if(!c.move){c.mouseDown(d)}});$("body").on("mouseup","#"+b,function(d){c.mouseUp(d)});$("body").on("mousemove","#"+b,function(d){if(c.down){c.mouseMove(d)}})},mouseMove:function(d){d&&d.preventDefault();this.move=true;var c=this._x-d.clientX,h=this._y-d.clientY,f=document.getElementById(b);f.scrollLeft=(this._left+c);f.scrollTop=(this._top+h)},mouseUp:function(c){c&&c.preventDefault();this.move=false;this.down=false;this.dragWrap.css("cursor","")},mouseDown:function(c){this.move=false;this.down=true;this._x=c.clientX;this._y=c.clientY;this._top=document.getElementById(b).scrollTop;this._left=document.getElementById(b).scrollLeft;this.dragWrap.css("cursor","move")}};var a=new a()}};function processHiddenInput(a,c){var b=getCheckedIds(a);$("#"+c).val(b)}var CheckboxUtil={init:function(parentId){var that=this;var checkboxs=null;if(parentId){checkboxs=$("#"+parentId).find("[data-checkbox]")}else{checkboxs=$("body").find("[data-checkbox]")}if(checkboxs&&checkboxs.length>0){var initCheckBoxEvent=function(ck,name,hiddenInputId,handler){ck.find("input[type='checkbox'][name='"+name+"']").unbind("change").on("change",function(){if(handler){var exe=eval(handler);if(exe){if(handler=="processHiddenInput"){processHiddenInput(name,hiddenInputId)}else{var input=$(this);exe(input,input.is(":checked"))}}}})};checkboxs.each(function(){var ck=$(this);var handler=ck.data("handler");var name=ck.data("name");var value=ck.data("value");var defaultValue=ck.data("default");var hiddenInputId=ck.data("hiddeninput");var url=ck.data("url");var label=ck.data("label");if(url){that.insertDatas(ck,url,name,label,function(){initCheckBoxEvent(ck,name,hiddenInputId,handler);that.setChecked(name,value,defaultValue)})}else{initCheckBoxEvent(ck,name,hiddenInputId,handler);that.setChecked(name,value,defaultValue)}})}},insertDatas:function(n,a,b,l,m){var h=this;n.empty();var c=n.data("width");var k="";var j="";if(c){var f=c.split(",");k=f[0];j=f[1]}else{k="100px";j="col"}var e="";if(l){if(k.indexOf("px")!=-1){e='<label class="col-auto col-form-label" style="width:'+k+'">'+l+"</label>"}else{e='<label class="'+k+' col-form-label">'+l+"</label>"}}var i="";var d=n.data("inline");if(d){i="checkbox-inline"}Ajax.get(a,function(p){e+='<div class="'+j+'"  style="padding-top: 1px;">';var r=p.data;var s=b.replace("\\.","_");if(r&&r.length>0){for(var o in r){s=s+"_"+o;var q='<div class="checkbox checkbox-primary '+i+'">'+'<input  id="'+s+'" type="checkbox" name="'+b+'" value="'+r[o].value+'"/>'+'<label for="'+s+'">'+r[o].text+"</label>"+"</div>";e+=q}e+="</div>";n.html(e);if(m){m()}}})},checkByArray:function(d,c){c=c.toString();if(c.indexOf(",")!=-1){var a=c.split(",");if(a&&a.length>0){for(var e in a){var b=$("input[type='checkbox'][name='"+d+"'][value='"+a[e]+"']");b.attr("checked","checked")}}}else{var b=$("input[type='checkbox'][name='"+d+"'][value='"+c+"']");b.attr("checked","checked")}},setChecked:function(b,d,a){var c=this;if(d){c.checkByArray(b,d)}else{if(a||a==0||a=="0"){c.checkByArray(b,a)}}}};var SummerNoteEditorUtil={ing:false,init:function(c){var b=this;
b.ing=false;var a=null;if(c){a=$("#"+c).find("[data-editor='summernote']")}else{a=$("body").find("[data-editor='summernote']")}if(a&&a.length>0){a.each(function(){b.initEditor($(this))})}},initEditor:function(e){var d=this;var c=e.data("width");var a=e.data("height");var f=e.data("placeholder");var b={lang:"zh-CN",toolbar:[["font",["bold","italic","underline","clear","strikethrough","superscript","subscript"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["insert",["table","link","picture"]],["misc",["fullscreen","undo","redo"]]],callbacks:{onImageUpload:function(m,l,j){if(d.ing){alert("有文件正在上传，请稍后~~")}else{d.ing=true;var h=m.length;for(var k=0;k<h;k++){if(m[k].size/1024>200){d.ing=false;alert("图片文件不能大于200k");return false}d.sendFile(e,m[k])}d.ing=false}},onChange:function(i,h){var k=e.data("hiddeninput");if(k){var j=$("#"+k);if(j&&j.length>0){j.val(i)}}},onPaste:function(h){if(d.ing){alert("有文件正在上传，请稍后~~")}else{d.parseIamge(h,e)}}}};if(f){b.placeholder=f}if(c){b.width=c+"px"}if(!a){a=300}b.height=a+"px";e.summernote(b)},parseIamge:function(j,d){var h=this;h.ing=true;var c=j.originalEvent;var f=c.clipboardData.files;if(!f||f.length==0){h.ing=false;return false}c.stopPropagation();c.preventDefault();for(var b in f){var a=f[b];if(h.ing==false||!(a.type.match(/^image/))){return false}if(a.size/1024>200){h.ing=false;alert("剪贴板中图片文件不能大于200k");return false}h.sendFile(d,a)}},sendFile:function(e,d){var f=this;f.ing=true;var b=e.data("imguploadurl");var a=e.data("fileinputname");var h=e.data("imghost");var c=new FormData();c.append(a,d);$.ajax({type:"post",url:b,data:c,timeout:60000,cache:false,async:false,processData:false,contentType:false,success:function(i){if(i.state=="ok"){if(i.data){e.summernote("insertImage",(h?h:"")+"/"+i.data)}LayerMsgBox.success("上传成功",1000)}else{LayerMsgBox.error(i.msg,1000)}f.ing=false},error:function(i){f.ing=false;LayerMsgBox.error("网络异常",1000)}})}};var RadioUtil={init:function(parentId){var that=this;var radios=null;if(parentId){radios=$("#"+parentId).find("[data-radio]")}else{radios=$("body").find("[data-radio]")}if(radios&&radios.length>0){var initRadioEvent=function(r,name,handler){if(handler){var exe=eval(handler);if(exe){r.find("input[type='radio'][name='"+name+"']").unbind("click").on("click",function(e){var r=$(this);var val=r.val();exe(r,val)})}}};radios.each(function(){var r=$(this);var value=r.data("value")+"";if(!value){value=""}else{value=value+""}var defaultValue=r.data("default")+"";if(!defaultValue){defaultValue=""}else{defaultValue=defaultValue+""}var name=r.data("name");var handler=r.data("handler");var url=r.data("url");var label=r.data("label");if(url){that.insertDatas(r,url,name,label,function(){initRadioEvent(r,name,handler);that.setChecked(name,value,defaultValue)})}else{initRadioEvent(r,name,handler);that.setChecked(name,value,defaultValue)}})}},insertDatas:function(a,b,c,m,n){var i=this;a.empty();var d=a.data("width");var l="";var k="";if(d){var h=d.split(",");l=h[0];k=h[1]}else{l="100px";k="col"}var f="";if(m){if(l.indexOf("px")!=-1){f='<label class="col-auto col-form-label" style="width:'+l+'">'+m+"</label>"}else{f='<label class="'+l+' col-form-label">'+m+"</label>"}}var j="";var e=a.data("inline");if(e){j="radio-inline"}Ajax.get(b,function(p){f+='<div class="'+k+'"  style="padding-top: 1px;">';var r=p.data;var s=c.replace("\\.","_");if(r&&r.length>0){for(var o in r){s=s+"_"+o;var q='<div class="radio radio-primary '+j+'">'+'<input  id="'+s+'" type="radio" name="'+c+'" value="'+r[o].value+'"/>'+'<label for="'+s+'">'+r[o].text+"</label>"+"</div>";f+=q}f+="</div>";a.html(f);if(n){n()}}})},setChecked:function(b,c,a){if(c&&c.length>0){$("input[type='radio'][name='"+b+"'][value='"+c+"']").click()}else{if(a){if(a=="all"){$("input[type='radio'][name='"+b+"'][data-all]").click()}else{if(a=="options_first"){$("input[type='radio'][name='"+b+"']:first").click()}else{if(a=="options_last"){$("input[type='radio'][name='"+b+"']:last").click()}else{$("input[type='radio'][name='"+b+"'][value='"+a+"']").click()}}}}}}};var LayerTipsUtil={init:function(c){var a=null;if(c){a=$("#"+c).find("[data-tipsbtn]")}else{a=$("body").find("[data-tipsbtn]")}var b=a.length>0;if(b){a.each(function(){var e=$(this);var d=e.data("trigger");if(d&&d=="click"){var f=0;e.on("click",function(i){i.stopPropagation();i.preventDefault();var h=$(this).data("content");f=layer.tips(h,this,{tips:[4,"#3595CC"],time:10000});$("#layui-layer"+f).on("click",function(j){j.stopPropagation();j.preventDefault()});$("body").on("click",function(){layer.close(f)})})}else{var f=0;e.on("mouseover",function(){var h=$(this).data("content");f=layer.tips(h,this,{tips:[4,"#3595CC"],time:4000})}).on("mouseout",function(){layer.close(f)})}})}}};var LayerPhotoUtil={init:function(c){var a=this;var b=null;if(c){photoBtns=$("#"+c).find("[data-photobtn]")}else{photoBtns=$("body").find("[data-photobtn]")}if(photoBtns&&photoBtns.length>0){photoBtns.unbind("click").on("click",function(h){h.preventDefault();
h.stopPropagation();var f=$(this);var d=null;if(this.tagName.toLowerCase()=="a"){d=f.attr("href")}else{if(this.tagName.toLowerCase()=="img"){d=f.attr("src")}}if(!d){d=f.data("url")}if(d){layer.photos({photos:{"title":"JBolt图片查看器","start":0,"data":[{"src":d,}]},anim:5})}else{alert("页面存在未设置图片地址的 photobtn")}})}}};(function(a){a.extend(a.fn,{ajaxPortal:function(c,b,d,e){return this.each(function(){var f=a(this);var h="";if(b){h=b}else{h=f.data("url")}if(h.indexOf("?")!=-1){h=h+"&t="+new Date().getTime()}else{h=h+"?t="+new Date().getTime()}var i=f.data("autoload");if(i==undefined){i=true}if((c==undefined&&i)||(c!=undefined)){a.get(h,function(k){if(c){f.empty().html(k)}else{f.append(k)}if(d&&b){f.data("url",b)}var j=f.attr("id");if(!j){j=randomId();f.attr("id",j)}afterAjaxPortal(j);if(e){e()}})}})}})})(jQuery);function afterAjaxPortal(b){var a=$("#"+b);a.find("[tooltip]").tooltip();a.find('[data-toggle="tooltip"]').tooltip();SelectUtil.autoLoad({"parent":a});SelectUtil.initAutoSetValue(b);JAtomFileUploadUtil.init(b);JAtomImgUploader.init(b);SwitchBtn.init(b);RadioUtil.init(b);CheckboxUtil.init(b);LayerPhotoUtil.init(b);LayerTipsUtil.init(b)}function validateFileMaxSize(d,e){var b=(d.files[0].size/1024).toFixed(1);var c=(b>e);var a=b+"KB";if(b>1024){a=((b/1024).toFixed(1))+"M"}if(c){LayerMsgBox.alert("您选择的文件["+a+"],上传限制不能超过 "+e+"KB",2)}return c}function validateExcel(a,c){var b=a.value;if(!/.(xls|xlsx)$/.test(b)){LayerMsgBox.alert("文件类型必须是xls,xlsx中的一种",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateNormal(a,c){var b=a.value;if(!/.(xls|xlsx|jpg|jpeg|png|JPG|rar|zip|pdf|mp4|flv|mp3|doc|docx)$/.test(b)){LayerMsgBox.alert("此文件类型不允许上传",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function isImg(a){return/.(jpg|jpeg|png|JPG)$/.test(a)}function validateImg(a,c){var b=a.value;if(isImg(b)==false){LayerMsgBox.alert("图片类型必须是jpeg,jpg,png中的一种",2);return false}if(validateFileMaxSize(a,c)){return false}return true}function validateFile(b,a,e){var d=b[0];if(!e){e=1024*1024*1024*2}var c=true;if(a){switch(a){case"img":c=validateImg(d,e);break;case"excel":c=validateExcel(d,e);break;case"file":c=validateNormal(d,e);break}}else{c=validateNormal(d,e)}return c}function getObjectURL(c){var b=c.files[0];var a=null;if(window.createObjectURL!=undefined){a=window.createObjectURL(b)}else{if(window.URL!=undefined){a=window.URL.createObjectURL(b)}else{if(window.webkitURL!=undefined){a=window.webkitURL.createObjectURL(b)}}}return a}var JAtomImgUploader={tpl:'<input type="file"   {@if rule}data-rule="${rule}"{@/if}  {@if tips}data-tips="${tips}"{@/if} ><p class="j_img_uploder_msg"><span class="j_file_name"></span><i class="fa fa-remove j_text_danger j_remove_file"></i></p>',init:function(d){var c=this;var b=d?("#"+d):"body";var a=$(b).find(".j_img_uploder");a.each(function(){var e=$(this);JAtomImgUploader.initSingle(e)})},initSingle:function(f){var e=this;var i=f.data("rule");var b=f.data("tips");var d=f.data("area");if(d){var a=d.split(",");f.css({"width":a[0],"height":a[1]})}f.html(juicer(e.tpl,{rule:i,tips:b}));var h=f.data("value");if(h&&h!="/assets/img/uploadimg.png"){var c="#999 url("+h+") center center no-repeat";f.css({"background":c,"background-size":"100%"});f.find("p.j_img_uploder_msg").show()}$(f).on("change","input[type='file']",function(k){var j=$(this);e.changeFile(j)}).on("click",".j_remove_file",function(){var j=$(this);e.removeFile(j)})},removeFile:function(removeBtn){var uploder=removeBtn.closest(".j_img_uploder");var removehandler=uploder.data("removehandler");uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});var hiddeninput=uploder.data("hiddeninput");if(hiddeninput){$("#"+hiddeninput).val("")}if(removehandler){var exe=eval(removehandler);if(exe){exe(uploder)}}},changeFile:function(file){var uploder=file.closest(".j_img_uploder");var maxSize=uploder.data("maxsize");var fileValue=file.val();var hiddeninput=uploder.data("hiddeninput");var handler=uploder.data("handler");if(hiddeninput&&handler&&handler!="uploadMultipleFile"){$("#"+hiddeninput).val("")}if(fileValue){if(validateFile(file,"img",maxSize)){var arr=fileValue.split("\\");var fileName=arr[arr.length-1];if(handler&&handler!="uploadMultipleFile"){uploder.find("span.j_file_name").text(fileName).attr("title",fileName);uploder.find("p.j_img_uploder_msg").show();var fileData=getObjectURL(file[0]);if(fileData){uploder.css({"background":"#999 url('"+fileData+"') center center no-repeat","background-size":"100%"})}}uploder.closest(".form-group").removeClass("has-error")}else{file.val("")}}else{uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"})}if(handler){var isMultiple=(handler=="uploadMultipleFile");
if(handler=="uploadFile"||isMultiple){var url=uploder.data("url");if(!url){LayerMsgBox.alert("未设置文件上传地址 data-url",2)}else{var hiddeninput=uploder.data("hiddeninput");var imgbox=uploder.data("imgbox");var limit=uploder.data("limit");var imgs=$("#"+imgbox+" img");if(imgs&&imgs.length>=limit){LayerMsgBox.alert("最多上传["+limit+"]张",5);uploder.find("input[type='file']").val("");uploder.find("span.j_file_name").text("");uploder.find("p.j_img_uploder_msg").hide();uploder.css({"background":"url('assets/img/uploadimg.png') center center no-repeat","background-size":"80%"});return false}var fileName=uploder.data("filename");if(!fileName){fileName="file"}uploadFile("img",url,fileName,file[0].files[0],hiddeninput,null,null,isMultiple,imgbox,function(){if(isMultiple){uploder.find("input[type='file']").val("")}})}}else{var exe=eval(handler);if(exe){exe(file.val(),file)}}}}};function processImagesHiddenInputValue(h,f){var a=$("#"+h);var b=$("#"+f);var e="";var i=a.find("img");var c=i.length;var d=c-1;if(c>0){i.each(function(k,l){var j=$(this);e=e+j.attr("src");if(k<d){e=e+","}})}b.val(e)}function removeUploadImgBoxLi(d){var b=$(d);var a=b.closest("li");var c=a.data("hiddeninput");var e=a.data("imgbox");a.remove();processImagesHiddenInputValue(e,c)}function imgGotoLeft(c){var f=$(c);var a=f.closest("li");var d=a.prev();if(d){var b=a.clone();d.before(b);var e=a.data("hiddeninput");var h=a.data("imgbox");a.remove();processImagesHiddenInputValue(h,e)}else{layer.msg("已经是第一个",{time:1000})}}function imgGotoRight(c){var f=$(c);var a=f.closest("li");var d=a.next();if(d){var b=a.clone();d.after(b);var e=a.data("hiddeninput");var h=a.data("imgbox");a.remove();processImagesHiddenInputValue(h,e)}else{layer.msg("已经是最后一个",{time:1000})}}function uploadFile(k,a,b,e,j,d,m,i,h,l){var f=parseInt((e.size/1024).toFixed(0));var c=new FormData();c.append(b,e);$.ajax({type:"post",url:a,data:c,timeout:60000,cache:false,async:false,processData:false,contentType:false,success:function(q){if(q.state=="ok"){if(m){$("#"+m).val(f)}if((k=="img")&&j&&q.data){var n=q.data;var r=$("#"+j);var p=$.trim(r.val());if(i&&h){$("#"+h).append("<li data-imgbox='"+h+"' data-hiddeninput='"+j+"'><img src='"+n+"'/><div class='optbox' ><i title='删除' onclick='removeUploadImgBoxLi(this)' class='fa fa-trash'></i><i onclick='imgGotoLeft(this)' class='fa fa-arrow-left' title='左移'></i><i title='右移' onclick='imgGotoRight(this)' class='fa fa-arrow-right'></i></div></li>");if(!p){p=n}else{p=p+","+n}}else{p=n}r.val(p)}else{if((k=="file")&&j&&q.data){$("#"+j).val(q.data.fileUrl);if(d){var o=$("#"+d).val();if((o&&o.length>2)==false){$("#"+d).val(q.data.fileName)}}}}if(l){l()}LayerMsgBox.success("上传成功",1000)}else{LayerMsgBox.error(q.msg,1000)}},error:function(n){LayerMsgBox.error("网络异常",1000)}})}function dataURItoBlob(b){var f=atob(b.split(",")[1]);var a=b.split(",")[0].split(":")[1].split(";")[0];var e=new ArrayBuffer(f.length);var c=new Uint8Array(e);for(var d=0;d<f.length;d++){c[d]=f.charCodeAt(d)}return new Blob([e],{type:a})}var JAtomFileUploadUtil={tpl:'<div class="j_upload_file"><input type="file"  {@if rule}data-rule="${rule}"{@/if} {@if tips}data-tips="${tips}"{@/if}  /></div><p class="j_upload_file_box_msg"><span class="j_file_name"></span><i class="fa fa-remove j_text_danger j_remove_file"></i></p>',init:function(parentId){var that=this;var parent=parentId?("#"+parentId):"body";var fileBoxs=$(parent).find(".j_upload_file_box");fileBoxs.each(function(){var box=$(this);var rule=box.data("rule");var tips=box.data("tips");box.html(juicer(that.tpl,{rule:rule,tips:tips}))});fileBoxs.find("input[type='file']").on("change",function(){var file=$(this);var box=file.closest(".j_upload_file_box");var accept=box.data("accept");var maxSize=box.data("maxsize");var fileValue=file.val();if(fileValue){if(validateFile(file,accept,maxSize)){var arr=fileValue.split("\\");var fileName=arr[arr.length-1];box.find("span.j_file_name").text(fileName);box.find("p.j_upload_file_box_msg").show();box.find(".j_upload_file").addClass("j_reupload");box.closest(".form-group").removeClass("has-error");var imgpreview=box.data("imgpreview");if(imgpreview){if(isImg(fileName)){var imgpreviewBox=$(imgpreview);if(imgpreviewBox&&imgpreviewBox.length){var url=getObjectURL(file[0]);if(url){imgpreviewBox.html("<img src='"+url+"'/>")}}}}}else{file.val("")}}else{that.clearIt(box)}var handler=box.data("handler");if(handler){if(handler=="uploadFile"){var url=box.data("url");if(!url){LayerMsgBox.alert("未设置文件上传地址 data-url",2)}else{var hiddeninput=box.data("hiddeninput");var sizeinput=box.data("sizeinput");var fileNameInput=box.data("filenameinput");var fileName=box.data("filename");if(!fileName){fileName="file"}uploadFile("file",url,fileName,file[0].files[0],hiddeninput,fileNameInput,sizeinput)}}else{var exe=eval(handler);if(exe){exe(file.val(),file)}}}});fileBoxs.find(".j_remove_file").on("click",function(){var removefile=$(this);var box=removefile.closest(".j_upload_file_box");that.clearIt(box)})},clearIt:function(b){b.find("input[type='file']").val("");
b.find("span.j_file_name").text("");b.find("p.j_upload_file_box_msg").hide();b.find(".j_upload_file").removeClass("j_reupload");var a=b.data("imgpreview");if(a){$(a).empty()}}};var LayerMsgBox={alert:function(c,b,a){if(b){layer.alert(c,{icon:b},function(d){if(a){a()}layer.close(d)})}else{layer.alert(c,function(d){if(a){a()}layer.close(d)})}},confirm:function(c,a,b){layer.confirm(c,{icon:3,title:"提示"},function(d){if(a){a()}layer.close(d)},function(d){if(b){b()}layer.close(d)})},success:function(d,c,b){if(!d){d="操作成功"}if(!c){c=1000}var a=layer.msg(d,{time:c,icon:1},function(){if(b){b()}});return a},error:function(d,c,b){if(!d){d="错误"}if(!c){c=1500}var a=layer.msg(d,{time:c,icon:2},function(){if(b){b()}});return a},prompt:function(d,e,c,b){if(b==undefined){b=2}var a=layer.prompt({title:d,value:(e?e:""),formType:b},function(h,f){if(c){c(f,h)}});return a},loading:function(d,c,b){if(!d){d="执行中..."}var a=null;c=(c?c:10000);if(c){a=layer.msg(d,{time:c,icon:16,shade:0.3},function(){if(b){b()}})}else{a=layer.msg(d,{icon:16})}return a},close:function(a){layer.close(a)},closeAll:function(a){if(a){layer.closeAll(a)}else{layer.closeAll()}},closeLoading:function(){setTimeout(function(){layer.closeAll("dialog")},500)},closeLoadingNow:function(){layer.closeAll("dialog")},load:function(a,b){if(b){layer.load(a,{time:b})}else{layer.load(a)}},closeLoad:function(){setTimeout(function(){layer.closeAll("loading")},200)},closeLoadNow:function(){layer.closeAll("loading")}};var Ajax={post:function(b,e,f,a,d){var c=true;if(d){c=false}$.ajax({url:b,type:"post",dataType:"json",timeout:60000,async:c,data:e,success:function(h){if(h.state=="ok"){if(f){f(h)}}else{LayerMsgBox.alert(h.msg,2);if(a){a()}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);if(a){a()}}})},get:function(b,e,a,d){var c=true;if(d){c=false}$.ajax({url:b,type:"get",dataType:"json",timeout:60000,async:c,success:function(f){if(f.state=="ok"){if(e){e(f)}}else{LayerMsgBox.alert(f.msg,2);if(a){a()}}},error:function(){LayerMsgBox.alert("网络通讯异常",2);if(a){a()}}})}};var SelectUtil={autoLoad:function(setting){var processItems=function(html,list,appendHandler){for(var i in list){var option='<option value="'+list[i].value+'">&nbsp;&nbsp;&nbsp;&nbsp; ∟'+list[i].text+"</option>";if(appendHandler){option=appendHandler(option,list[i])}html+=option}return html};var insert=function(_this,refreshing){var selectedValue=_this.data("select");if(refreshing){selectedValue=_this.val()}var handler=_this.data("handler");var appendHandler=_this.data("append");if(appendHandler){appendHandler=eval(appendHandler)}_this.empty();if(_this.data("text")){_this.append('<option value="'+_this.data("value")+'">'+_this.data("text")+"</option>")}var url=null;if(setting&&setting.url){url=setting.url}else{url=_this.data("url")}if(url!=null){$.ajax({type:"GET",url:url,dataType:"json",timeout:10000,context:_this,success:function(result){if(refreshing){LayerMsgBox.closeLoading()}if(result.state=="ok"){var html="";var list=result.data;for(var i in list){var option='<option value="'+list[i].value+'">'+list[i].text+"</option>";if(appendHandler){option=appendHandler(option,list[i])}html+=option;var items=list[i].items;if(items&&items.length>0){html=processItems(html,items,appendHandler)}}_this.append(html);if(selectedValue||(typeof(selectedValue)=="boolean")){selectedValue=selectedValue.toString();if(selectedValue.indexOf(",")!=-1){var arr=selectedValue.split(",");_this.val(arr)}else{_this.val(selectedValue)}if(!_this.val()){var options=_this.find("option");if(options&&options.length>0){_this.val(options.eq(0).val())}}}_this.change()}if(setting&&setting.handler){setting.handler(_this)}if(handler){var exe=eval(handler);if(exe){exe(_this)}}}})}};var select=null;if(setting){if(setting.selectId){if(setting.parent){if(typeof setting.parent=="object"){select=setting.parent.find("#"+setting.selectId)}else{if(setting.parent.indexOf("#")!=-1){select=$(setting.parent).find("#"+setting.selectId)}else{select=$("#"+setting.parent).find("#"+setting.selectId)}}}else{select=$("#"+setting.selectId)}}else{if(setting.parent){if(typeof setting.parent=="object"){select=setting.parent.find("select[data-autoload]")}else{if(setting.parent.indexOf("#")!=-1){select=$(setting.parent).find("select[data-autoload]")}else{select=$("#"+setting.parent).find("select[data-autoload]")}}}else{select=$("select[data-autoload]")}}}else{select=$("select[data-autoload]")}select.each(function(i,obj){var _this=$(this);var islinkage=_this.data("linkage");_this.unbind("change");_this.on("change",function(){var beforechange=_this.data("beforechange");if(beforechange){var exe=eval(beforechange);if(exe){exe(_this)}}var sonId=_this.data("sonid");if(islinkage&&sonId){var srcUrl=$("#"+sonId).data("srcurl");var url="";if(srcUrl){url=srcUrl+"/"+_this.val()}else{url=$("#"+sonId).data("url")+"/"+_this.val()}SelectUtil.autoLoad({parent:_this.parents("form"),selectId:sonId,url:url})}});if((_this.data("url")||setting.url)){insert(_this);if(_this.data("refresh")){var exist=_this.parent().find(".glyphicon-refresh");
if(exist&&exist.size()>0){exist.parent().remove()}var refreshBtn=document.createElement("div");refreshBtn.className="input-group-addon handcursor";refreshBtn.innerHTML='<span class="glyphicon glyphicon-refresh"></span>';$(refreshBtn).click(function(){LayerMsgBox.loading("正在刷新数据...",10000);insert(_this,true)});obj.parentElement.appendChild(refreshBtn)}}else{var selectedValue=_this.data("select");if(selectedValue){_this.val(selectedValue)}}})},setValue:function(c,b,a){if(b){$("#"+c).val(b)}else{if(a){$("#"+c).val(a)}}},initAutoSetValue:function(a){$(a?("#"+a):"body").find("select[data-autosetvalue]").each(function(){var b=$(this);var c=b.data("autosetvalue");b.val(""+c)})}};$.fn.size=function(){return this.length};function removeTr(a){$(a).closest("tr").remove()}function removeByKey(b){var a=$(b).data("removekey");$("[data-removekey='"+a+"']").remove()}function eleMoveUp(b){var a=b.prev();if(b.index()>0){b.insertBefore(a)}}function eleMoveDown(b){var a=b.next();if(a){b.insertAfter(a)}}var PageOptUtil={init:function(){var a=this;a.initDialogOptEvent();a.initAjaxLinkEvent();a.initPortalLink()},initDialogOptEvent:function(){$(document).on("click","[data-dialogbtn]",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})},initAjaxLinkEvent:function(){$(document).on("click","[data-ajaxbtn]",function(e){e.preventDefault();e.stopPropagation();var action=$(this);var url=action.attr("href");if(!url){url=action.data("url")}if(!url){alert("请设置URL地址");return false}var okhandler=action.attr("handler");if(!okhandler){okhandler=action.data("handler")}var dataconfirm=action.data("confirm");var dataloading=action.data("loading");var ajaxFun=function(){LayerMsgBox.loading(dataloading,60000);Ajax.get(url,function(data){if(okhandler){LayerMsgBox.closeLoadingNow();if(okhandler=="removeTr"){removeTr(action)}else{if(okhandler=="removeByKey"){removeByKey(action)}else{if(okhandler=="moveUp"){eleMoveUp(action.closest("tr"))}else{if(okhandler=="moveDown"){eleMoveDown(action.closest("tr"))}else{if(okhandler=="refreshPortal"){var portalId=action.data("portal");if(portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+portalId).ajaxPortal(true)})}}else{var exe=eval(okhandler);if(exe){exe(data)}}}}}}}else{LayerMsgBox.closeLoading()}})};if(dataconfirm){LayerMsgBox.confirm(dataconfirm,ajaxFun)}else{ajaxFun()}return false})},initPortalLink:function(){$(document).on("click","[data-portalbtn]",function(f){f.preventDefault();f.stopPropagation();var d=$(this);var b=d.data("portalid");if(!b){alert("请设置data-portalid");return false}var c=d.attr("href");if(!c){c=d.data("url")}if(!c){alert("请设置URL地址");return false}var a=$("#"+b);if(!a||a.length==0){alert("data-portalid不正确");return false}LayerMsgBox.loading("正在匹配...",30000);a.ajaxPortal(true,c,true,function(){LayerMsgBox.success("匹配完成",500)})})}};var TableUtil={init:function(){var a=this;a.initDelOptEvent();a.initEditOptEvent();a.initAddOptEvent()},initDelOptEvent:function(){$(document).on("click",".jbolt_table_delbtn",function(e){e.preventDefault();e.stopPropagation();var action=$(this);var url=action.attr("href");var okhandler=action.attr("handler");if(!okhandler){okhandler=action.data("handler")}var confirm=action.data("confirm");LayerMsgBox.confirm(confirm?confirm:"确定删除此项？",function(){LayerMsgBox.loading("删除中",10000);Ajax.get(url,function(ret){LayerMsgBox.closeLoading();LayerMsgBox.success(ret.msg?ret.msg:"操作成功");if(okhandler){if(okhandler=="removeTr"){removeTr(action)}else{if(okhandler=="removeByKey"){removeByKey(action)}else{if(okhandler=="refreshPortal"){var portalId=action.data("portal");if(portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+portalId).ajaxPortal(true)})}}else{var exe=eval(okhandler);if(exe){exe()}}}}}})});return false})},initEditOptEvent:function(){$(document).on("click",".jbolt_table_editbtn",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})},initAddOptEvent:function(){$(document).on("click",".jbolt_table_addbtn",function(b){b.preventDefault();b.stopPropagation();var a=$(this).data("target");if(a=="parent"){parent.DialogUtil.openBy(this)}else{if(a=="outparent"){parent.parent.DialogUtil.openBy(this)}else{DialogUtil.openBy(this)}}return false})}};var FormDate={init:function(c){var a=null;if(c){a=$("#"+c).find("[data-date]")}else{a=$("body").find("[data-date]")}var b=(a&&a.length>0);if(b){a.attr("readonly","readonly");a.each(function(){var d=$(this);var e=d.data("type");if(!e){e="date"}var f=d.data("fmt");if(!f){switch(e){case"date":f="yyyy-MM-dd";break;case"time":f="HH:mm";break;case"datetime":f="yyyy-MM-dd HH:mm";break;default:f="yyyy-MM-dd";break}}var h=d.attr("id");if(!h){h=d.attr("name");h=h.replace(".","");d.attr("id",h)
}laydate.render({elem:"#"+h,type:e,format:f})})}}};var DialogUtil={openBy:function(r){var f=$(r);var b=f.data("url");if(!b){b=f.attr("href")}if(!b){LayerMsgBox.alert("没有设置dialog的url. href 或者 dialog-url",2);return false}var o=f.data("title");var q=f.attr("handler");if(!q){q=f.data("handler")}var i=f.data("area");var p="800px";var l="500px";if(i){var c=i.split(",");var j=c[0];var e=c[1];if(j.indexOf("px")!=-1||j.indexOf("%")!=-1){p=j}else{p=j+"px"}if(e.indexOf("px")!=-1||e.indexOf("%")!=-1){l=e}else{l=e+"px"}}var a=f.data("scroll");if(!a){a="no"}else{a="yes"}var m=f.data("fs");if(m&&(m=="true"||m==true)){a="yes"}var n=f.data("cdrfp");if(n==undefined){n=false}var k=f.data("portal");var d=f.data("btn");this.openNewDialog({title:o,width:p,height:l,url:b,scroll:a,btn:d,handler:q,cdrfp:n,fs:m,portalId:k})},openNewDialog:function(options){var btn=[];var dbtn=options.btn;if(!dbtn){btn=["确定","关闭"]}else{if(dbtn&&dbtn=="no"){btn=[]}else{if(dbtn&&dbtn=="close"){btn=["确定","关闭"]}}}var lindex=layer.open({type:2,title:options.title,shadeClose:false,shade:0.5,maxmin:true,area:[options.width,options.height],content:[options.url,options.scroll],btn:btn,yes:function(index){var iframeWin=window[$(".layui-layer-iframe").find("iframe")[0]["name"]];iframeWin.submitThisForm(function(){LayerMsgBox.close(index);if(options.handler){if(options.handler=="refreshPortal"){if(options.portalId){LayerMsgBox.success("操作成功",500,function(){$("#"+options.portalId).ajaxPortal(true)})}else{LayerMsgBox.alert("没有配置data-portalid",2)}}else{var exe=eval(options.handler);if(exe){exe()}}}})},end:function(){if(options.cdrfp){refreshPjaxContainer()}}});if(options.fs){layer.full(lindex)}if(dbtn&&dbtn=="close"){$("#layui-layer"+lindex).find("a.layui-layer-btn0").hide()}if(dbtn&&dbtn=="no"){$("#layui-layer"+lindex).find(".layui-layer-btn").remove()}}};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};Date.prototype.format=function(a){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()};if(/(y+)/.test(a)){a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var b in c){if(new RegExp("("+b+")").test(a)){a=a.replace(RegExp.$1,(RegExp.$1.length==1)?(c[b]):(("00"+c[b]).substr((""+c[b]).length)))}}return a};function isArray(a){return(typeof a=="object")&&a.constructor==Array}function isEmpty(a){return(a=="undefined"||a==null||a==""||a==false)}function isNotEmpty(a){return((a!=null&&a!="undefined"&&a!="")||a==true)}var g=function(a){return"string"==typeof a?document.getElementById(a):a};jQuery.fn.shake=function(a,c,b){this.each(function(){var e=$(this);e.css({position:"relative"});for(var d=1;d<=a;d++){e.animate({left:(c*-1)},(((b/a)/4))).animate({left:c},((b/a)/2)).animate({left:0},(((b/a)/4)))}});return this};function processCheckTab(a){var b=a.closest("div[role='tabpanel']");if(b&&b.size()==1){var c=b.attr("id");$(".nav.nav-tabs .nav-item.nav-link[href='#"+c+"']").tab("show")}}function showItCheckResult(a){a.parents(".form-group").removeClass("bdc-success").addClass("bdc-danger");a.shake(2,10,400);a.focus()}function TestRgexp(b,a){return b.test(a)}var ruleMap=[{type:"number",method:function(a){return(!isNaN(a))}},{type:"pznumber",method:function(a){return(!isNaN(a)&&a*1>=0)}},{type:"pzint",method:function(a){return((TestRgexp(/^-?[0-9]\d*$/,a))&&(a*1>=0))}},{type:"pnumber",method:function(a){return(!isNaN(a)&&a*1>0)}},{type:"int",method:function(a){return TestRgexp(/^-?[0-9]\d*$/,a)}},{type:"pint",method:function(a){return TestRgexp(/^[0-9]*[1-9][0-9]*$/,a)}},{type:"email",method:function(a){return TestRgexp(/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,a)}},{type:"filepath",method:function(a){return TestRgexp(/^([a-zA-Z]){1}:(\\[^\/\\:\*\?\"<>]+)*(\\)?$/,a)}},{type:"url",method:function(a){return TestRgexp(/^([a-zA-Z]){1}:(\\[^\/\\:\*\?\"<>]+)*(\\)?$/,a)}},{type:"date",method:function(a){return TestRgexp(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/,a)}},{type:"money",method:function(a){return TestRgexp(/^(?!0\.00)(?:0|[1-9]\d*)(?:\.\d{1,2})?$/,a)}},{type:"phone",method:function(a){return TestRgexp(/^(\(\d{3,4}\)|\d{3,4}-|\s)?\d{7,14}$/,a)}},{type:"password",method:function(b){if(!b){return false}var a=b.length;return a>=6&&a<=16}},{type:"select",method:function(a){return(a&&a!=""&&a!="0"&&a!="-1"&&a.length>0)}}];var isDOM=(typeof HTMLElement==="object")?function(a){return a instanceof HTMLElement}:function(a){return a&&typeof a==="object"&&a.nodeType===1&&typeof a.nodeName==="string"};var FormChecker={checkIt:function(h){var d=this;var c=null;if(typeof h=="string"){c=$("#"+h)}else{if(typeof h=="object"){if(isDOM(h)){c=$(h)}else{c=h}}}var e=true;if(c.is(":disabled")){return true}if(typeof(c.data("rule"))!="undefined"){var a=d.checktype(c);var f=c.next().hasClass("input-group-addon");var i=c.prev().hasClass("input-group-addon");var b=c.is("textarea");if(!a){e=false;if(c.is("input")&&c.attr("type")=="hidden"){return
}c.parents(".form-group").removeClass("bdc-success").addClass("bdc-danger");processCheckTab(c);c.shake(2,10,400);c.focus();if(c.is("input")&&c.attr("type")=="file"){return}}else{e=true;if(c.is("input")&&c.attr("type")=="hidden"){return}c.parents(".form-group").removeClass("bdc-danger").addClass("bdc-success");if(c.is("input")&&c.attr("type")=="file"){return}}}return e},check:function(d){var a=null;if(typeof d=="string"){a=$("#"+d)}else{if(typeof d=="object"){if(isDOM(d)){a=$(d)}else{a=d}}}var b=this;var c=true;a.find("input,textarea,select,[data-rule='checkbox'],[data-rule='radio']").each(function(){if(!c){return c}var h=$(this);if(h.is(":disabled")){return true}if(typeof(h.data("rule"))!="undefined"){var e=b.checktype(h);var i=h.next().hasClass("input-group-addon");var j=h.prev().hasClass("input-group-addon");var f=h.is("textarea");if(!e){c=false;if(h.is("input")&&h.attr("type")=="hidden"){return}h.parents(".form-group").removeClass("bdc-success").addClass("bdc-danger");processCheckTab(h);h.shake(2,10,400);h.focus();if(h.is("input")&&h.attr("type")=="file"){return}}else{c=true;if(h.is("input")&&h.attr("type")=="hidden"){return}h.parents(".form-group").removeClass("bdc-danger").addClass("bdc-success");if(h.is("input")&&h.attr("type")=="file"){return}}}});return c},checkCheckboxRequired:function(d,f,b){var c=this;var e=d.data("name");if(!e){return false}var h=$("input[type='checkbox'][name='"+e+"']:checked");if(h&&h.length>0){d.removeClass("bdc-danger").addClass("bdc-success");return true}d.removeClass("bdc-success").addClass("bdc-danger");d.shake(2,10,400);d.focus();var a=d.data("tips");if(!a){a="必须选择至少一个选项"}c.showMyTipsIfNeed(d,a,b);return false},checkRadioRequired:function(d,f,b){var c=this;var e=d.data("name");if(!e){return false}var h=$("input[type='radio'][name='"+e+"']:checked");if(h&&h.length>0){d.removeClass("bdc-danger").addClass("bdc-success");return true}d.removeClass("bdc-success").addClass("bdc-danger");d.shake(2,10,400);d.focus();var a=d.data("tips");if(!a){a="必须选择至少一个选项"}c.showMyTipsIfNeed(d,a,b);return false},checktype:function(c){var b=this;var f=c.data("rule");if(!f){return true}var d=c.data("tips"),a=c.data("show"),e=c.data("notnull");var h=null;if(f=="checkbox"){if(e==null||e==true||e=="true"){return b.checkCheckboxRequired(c,d,a)}else{return true}}else{if(f=="radio"){if(e==null||e==true||e=="true"){return b.checkRadioRequired(c,d,a)}else{return true}}else{h=c.val()}}if(a!=null){g(a).innerHTML=""}if(typeof h=="string"){h=h.trim()}if(!h){if(e==null||e==true||e=="true"){if(!d){if(c.attr("type")=="file"){d="此文件必须上传"}else{d="必填项"}}if(a==null){LayerMsgBox.error("<span class='j_text_danger'>"+d+"</span>",1500)}else{g(a).innerHTML=d}return false}else{return true}}return b.checkTypes(c,f,h,d,a,e)},checkTypes:function(k,j,l,e,m,c){var o=this;var f=j.split(";");var a=true;var h=1;var n=2;var b=3;for(var d=0;d<f.length;d++){var j=f[d];var p=o.checkSelf(k,j,l,e,m,c);if(p!=b){if(p==n){continue}else{a=false;break}}p=o.checkCompare(k,j,l,e,m,c);if(p!=b){if(p==n){continue}else{a=false;break}}}return a},checkCompare:function(h,e,i,d,j,c){var m=this;var f=1;var k=2;var b=3;var a=m.getRealTypeValue(i);var l=m.getCompareValue(e);if(e.indexOf("len=")!=-1){if(i.length==l){return k}if(!d){d="长度必须等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len>=")!=-1){if(i.length>=l){return k}if(!d){d="长度必须大于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len>")!=-1){if(i.length>l){return k}if(!d){d="长度必须大于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf(">=")!=-1){if(a>=l){return k}if(!d){d="必须大于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len<=")!=-1){if(i.length<=l){return k}if(!d){d="长度必须小于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("len<")!=-1){if(i.length<l){return k}if(!d){d="长度必须小于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("<=")!=-1){if(a<=l){return k}if(!d){d="必须小于等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf(">")!=-1){if(a>l){return k}if(!d){d="必须大于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("<")!=-1){if(a<l){return k}if(!d){d="必须小于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("!=")!=-1){if(a!=l){return k}if(!d){d="不能等于"+l}m.showMyTipsIfNeed(h,d,j);return f}else{if(e.indexOf("==")!=-1){if(a==l){return k}if(!d){d="必须等于"+l}m.showMyTipsIfNeed(h,d,j);return f}}}}}}}}}}}return b},getRealTypeValue:function(a){if(!isNaN(a)){return Number(a)}return a},getCompareValue:function(b){var a=this;if(b.indexOf("#")!=-1){var c=b.substring(b.indexOf("#"));return a.getRealTypeValue($(c).val())}else{if(b.indexOf("len=")!=-1){return a.getRealTypeValue(b.substring(4))}if(b.indexOf("len")!=-1){b=b.substring(3)}if(b.indexOf("=")!=-1){return a.getRealTypeValue(b.substring(2))}else{return a.getRealTypeValue(b.substring(1))}}},showMyTipsIfNeed:function(b,c,a){if(c!=null){if(a==null){LayerMsgBox.error("<span class='j_text_danger'>"+c+"</span>",3000)}else{g(a).innerHTML=c}}},checkSelf:function(j,f,k,e,l,c){var n=this;var h=1;var m=2;
var b=3;if(f=="string"){return m}var a=false;for(var d=0;d<ruleMap.length;d++){if(f==ruleMap[d].type){a=true;var o=ruleMap[d].method.call(this,k);if(!o){if(!e){switch(f){case"email":e="Email格式不正确";break;case"phone":e="电话号码格式不正确";break;case"number":e="必须为数字";break;case"pnumber":e="必须为正数";break;case"pznumber":e="不能为负数";break;case"pzint":e="必须为0或正整数";break;case"int":e="必须为整数";break;case"pint":e="必须为正整数";break;case"date":e="必须为日期格式";break;case"password":e="密码长度必须为6~16个字符";break;case"select":e="必须选择一项";break}}n.showMyTipsIfNeed(j,e,l);return h}}}return a?m:b}};function initAdminLeftNav(){$("body").on("click",".jbolt_admin_left_navs .jbolt_admin_nav .jbolt_menu_group",function(){$(".jbolt_admin").removeClass("hideMenu").addClass("normalMenu");localStorage.setItem("jbolt_hideMenu",false);var d=$(".jbolt_admin_left_navs");var c=$(this);var i=c.closest("nav");var b=$(".jbolt_admin_left_navs .jbolt_admin_nav.expansion");if(!c.hasClass("l1link")){if(d.hasClass("allexpansion")){return false}var h=b.data("key");var e=i.data("key");var f=c.find("i.fa").last();if(f.hasClass("fa-angle-down")){f.removeClass("fa-angle-down").addClass("fa-angle-left")}else{f.removeClass("fa-angle-left").addClass("fa-angle-down")}if(h!=e){b.removeClass("expansion")}$(this).parent().toggleClass("expansion")}else{b.removeClass("expansion");b.find(".jbolt_menu_group i.fa.fa-angle-down").removeClass("fa-angle-down").addClass("fa-angle-left");i.addClass("expansion");i.find(".jbolt_menu_group i.fa.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-down")}});var a=localStorage.getItem("jbolt_hideMenu");if(a=="true"){$(".jbolt_admin_nav.expansion").removeClass("expansion");$(".jbolt_admin").addClass("hideMenu")}else{$(".jbolt_admin").addClass("normalMenu")}resizeMorris()}function initTabs(){$("#myTab a").on("click",function(a){a.preventDefault();$(this).tab("show")})}function sendPjax(b,a,c){$.pjax({url:b,container:a,extData:c})}function pjaxSubmitForm(b){var d=$(b);var c=b.action;var a=d.serialize();if(c.indexOf("?")!=-1){c=c+"&"+a}else{c=c+"?"+a}$.pjax({url:c,container:mainPjaxContainer});return false}function initAdminPjax(){$.pjax.defaults.timeout=5000;$(document).pjax("a[data-pjax]:not([target]),[data-pjax] a:not([target])",mainPjaxContainer);$(document).on("pjax:timeout",function(a){LayerMsgBox.closeLoad();a.preventDefault()});$(document).on("submit","form[data-pjaxsubmit]",function(a){var b=$(this).data("needcheck");if(b){if(FormChecker.check(this)){$.pjax.submit(a,mainPjaxContainer)}}else{$.pjax.submit(a,mainPjaxContainer)}return false});$(document).on("pjax:start",function(){LayerMsgBox.load(3)});$(document).on("pjax:end",function(){afterPjax();LayerMsgBox.closeLoad()})}function refreshPjaxContainer(){$.pjax.reload(mainPjaxContainer)}function initOpenLeftNav(){var b=$("div.jbolt_page[data-key]");if(b&&b.size()>0){var a=b.data("key");openLeftNav(a)}}function openLeftNav(b){var a=$(".jbolt_admin_nav.expansion");a.removeClass("expansion");a.find(".jbolt_menu_group i.fa.fa-angle-down").removeClass("fa-angle-down").addClass("fa-angle-left");$(".jbolt_admin_left_navs nav.jbolt_admin_nav a.active").removeClass("active");$(".jbolt_admin_left_navs nav.jbolt_admin_nav a").each(function(){var d=$(this);var c=d.attr("href");if(b==c){d.addClass("active");var e=d.closest("nav");if(e&&e.size()==1){e.addClass("expansion");e.find(".jbolt_menu_group i.fa.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-down")}return false}})}function afterPjax(){initOpenLeftNav();$(".tooltip.show").remove();$(mainPjaxContainer+" [tooltip]").tooltip();$(mainPjaxContainer+' [data-toggle="tooltip"]').tooltip();$("[data-ajaxportal]").ajaxPortal(true);SelectUtil.autoLoad({"parent":mainPjaxContainer});SelectUtil.initAutoSetValue(mainPjaxContainerId);JAtomFileUploadUtil.init(mainPjaxContainerId);JAtomImgUploader.init(mainPjaxContainerId);SwitchBtn.init(mainPjaxContainerId);RadioUtil.init(mainPjaxContainerId);FormDate.init(mainPjaxContainerId);SummerNoteEditorUtil.init(mainPjaxContainerId);CheckboxUtil.init(mainPjaxContainerId);LayerPhotoUtil.init(mainPjaxContainerId);LayerTipsUtil.init(mainPjaxContainerId);getNoticeCount()}function getCheckedIds(b){var c=new Array();var a=$("input[name='"+b+"']:checked");a.each(function(d){c.push($(this).val())});if(c.length>0){return c.join(",")}return""}function pageSubmitForm(f,e,c,d){if(!d){var a=$("#gonu");if(a&&a.length>0){d=a.val()}else{d=1}}var b=$("#"+e);b.append('<input type="hidden" name="page" value="'+d+'"/>');b.submit()}function initPage(e,b,a,d){var c=$("#"+d).attr("action");$("#"+e).pagination(b,{num_edge_entries:1,current_page:(a-1),callback:function(f,h){if(isNaN(f)==false){var i=f+1;pageSubmitForm(e,d,c,i);return false}}});$("#gonu").on("keydown",function(f){if(f.keyCode==109||f.keyCode==189){return false}});$(".page-btn").one("click",function(){pageSubmitForm(e,d,c)})}function getNoticeCount(){}function toggleMenuEvent(){$("body").on("click",".leftMenuBtn",function(){$(".jbolt_admin_nav.expansion").removeClass("expansion");
$(".jbolt_admin").toggleClass("hideMenu").toggleClass("normalMenu");var a=$(".jbolt_admin").hasClass("hideMenu");if(a==false){initOpenLeftNav()}localStorage.setItem("jbolt_hideMenu",a);resizeMorris()})}function resizeMorris(){setTimeout(function(){windowResize()},1000)}function windowResize(){if(document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent("resize",true,true);window.dispatchEvent(a)}else{if(document.createEventObject){window.fireEvent("onresize")}}}function goback(){history.go(-1)}function reloadCurrentPage(){history.go(0)}function hideParentLayerDialogBtn(a){parent.$(".layui-layer-btn").children().eq(a).hide()}function hideAllParentLayerDialogBtn(){parent.$(".layui-layer-btn").hide()}function changeParentLayerDialogBtnTitle(a,b){parent.$(".layui-layer-btn").children().eq(a).text(b)}function getParentLayerDialogBtn(a){return parent.$(".layui-layer-btn").children().eq(a)}function showParentLayerDialogBtn(a){if(a){parent.$(".layui-layer-btn").children().eq(a).show()}else{parent.$(".layui-layer-btn").show()}}function addParentLayerDialogBtn(e,b,a){var d=randomId();var f="lay_btn_"+d;var c=$("<a id='"+f+"' class='"+b+"'>"+e+"</a>");c.on("click",function(h){h.preventDefault();h.stopPropagation();if(a){a()}});parent.$(".layui-layer-btn").find("a.layui-layer-btn0").after(c);return f}$(function(){initAdminLeftNav();getNoticeCount();var b=$("#pjaxScript");var a=b&&b.length==1;if(needPjax&&a){initAdminPjax();afterPjax();DragScrollUtil.init("dragScroll")}else{SelectUtil.autoLoad();SelectUtil.initAutoSetValue();JAtomFileUploadUtil.init();JAtomImgUploader.init();SwitchBtn.init();RadioUtil.init();FormDate.init();SummerNoteEditorUtil.init();CheckboxUtil.init();LayerPhotoUtil.init();LayerTipsUtil.init();$("[data-ajaxportal]").ajaxPortal();$("[tooltip]").tooltip();$('[data-toggle="tooltip"]').tooltip()}initTabs();TableUtil.init();PageOptUtil.init();toggleMenuEvent()});